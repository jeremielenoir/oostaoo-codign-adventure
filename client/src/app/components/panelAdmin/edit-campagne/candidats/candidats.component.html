<div [ngSwitch]="ViewCandidats" (click)="menuChoince($event)" class="big-content">
  <!-- <mat-card
    *ngIf="isLoading2"
    style="display: flex; justify-content: center; align-items: center"
  >
    <mat-progress-spinner color="primary" mode="indeterminate">
    </mat-progress-spinner>
  </mat-card> -->



  <div *ngSwitchCase="'CandidatFalse'" id="editQuestion">
    <p class="style-link">
      LINK page
    </p>
    <div class="border1pxgray">
      <div class="border1pxdashedgray">
        <div id="img-editquestion"></div>
        <h1>
          Votre campagne est prête. Il est temps d'inviter quelques candidats !
        </h1>

        <button mat-raised-button color="primary" class="btn-question" mat-button (click)="openDialog()">
          Invitez des candidats
        </button>
      </div>
    </div>
  </div>

  <div *ngSwitchCase="'CandidatTrue'" id="editQuestion">

    <div id="shadow-cog" [class.shadow-cog-active]="bolleanAnonymiser">
      <div id="remove" (click)="removeAnonymiser()"></div>

      <div class="modall">
        <div class="modall-header">
          <h3 class="modall-title">
            Options des événements
          </h3>
        </div>

        <div class="modall-content">
          <i class="fas fa-user-secret content-icon"></i>

          <h4 class="modal-content-title">Anonymiser</h4>
          <p class="content">
            Dans le cadre de la protection des données personnelles, vous êtes sur le point de procéder à
            l'anonymisation
            de ce/cette candidat(e) : ses données personnelles seront supprimées.
            Cependant, ses résultats et son rapport d'évaluation resteront visibles dans votre liste candidats de
            manière
            anonyme pour vous permettre de comparer son score aux candidats ultérieurs.
          </p>

        </div>
        <div class="modall-footer">
          <button class="btn-modal" (click)="removeAnonymiser()">Annuler</button>
          <button class="btn-modal" (click)="AnonymiserFinal()">Anonymiser ce candidat</button>
        </div>
      </div>
    </div>
    <div id="shadow-cog" [class.shadow-cog-active]="bolleanDeleteCandidat">
      <div id="remove" (click)="removeDeleteCandidat()"></div>

      <div class="modall">
        <div class="modall-header">
          <h3 class="modall-title">
            Supprimer le candidat
          </h3>
        </div>

        <div class="modall-content">
          <i class="fas fa-close content-icon"></i>

          <h4 class="modal-content-title">Supprimer</h4>
          <p class="content">
            Attention, vous êtes sur le point de supprimer ce/cette candidat(e) de votre liste.
            Dans le cadre de la protection des données personnelles, ses données seront anonymisées et vous ne pourrez
            plus accéder à ses résultats.
          </p>

        </div>
        <div class="modall-footer">
          <button class="btn-modal" (click)="removeDeleteCandidat()">Annuler</button>
          <button class="btn-modal" (click)="delteCandidat()">Supprimer ce candidat</button>
        </div>
      </div>
    </div>
    <div class="barre-nav">
      <div class="diplex-1">
        <div class="select-choince" (click)="showChoinceList($event)">

          <i class="fas fa-hand-pointer icon-choince"></i>

          <span class=""
            [class.selected-text-active]="nbrSelectedElementChecked.length > 0">{{nbrSelectedElementChecked.length > 0 ? nbrSelectedElementChecked.length : '0'}}
            sélectionné</span>

          <i class="fas fa-caret-down icon-choince-croche"></i>

          <ul class="menu-choince" (click)="showChoinceList($event)" [class.choince-active]="choinceList">

            <li class="menu-list-choince">
              <button (click)="exported()" class="first-btn"
                [class.selected-button]="nbrSelectedElementChecked.length > 0"
                [disabled]="nbrSelectedElementChecked.length == 0">
                <i class="fas fa-file-export icon-choince icon"></i>
                <span>Exporter</span>
              </button>
            </li>
            <li class="menu-list-choince">
              <button (click)="Anonymiser()" [class.selected-button]="nbrSelectedElementChecked.length > 0"
                [disabled]="nbrSelectedElementChecked.length == 0">
                <i class="fas fa-user-secret icon-choince icon"></i>
                <span>Anonymiser</span>
              </button>
            </li>
            <li class="menu-list-choince">
              <button (click)="deleteCandidat()" [class.selected-button]="nbrSelectedElementChecked.length > 0"
                [disabled]="nbrSelectedElementChecked.length == 0">
                <i class="fas fa-trash-alt icon-choince icon"></i>
                <span>Supprime</span>
              </button>
            </li>

          </ul>

        </div>

        <div class="custom-input-filtre-contenu">
          <i class="fas fa-search icon-search"></i>
          <input class="custom-input-filtre" matInput (keyup)="applyFilter($event.target.value)" placeholder="Filter" />
        </div>
      </div>



      <button mat-raised-button color="primary" class="btn-question fix-button" mat-button (click)="openDialog()">
        Invitez des candidats
      </button>

      <!--Table-->

      <div class="table-container mat-elevation-z8">
        <table mat-table [dataSource]="infosCandidats" matSort>
          <!-- Item Column -->

          <ng-container *ngFor="let column of displayedColumns; let i = index" [matColumnDef]="column">

            <!-- CHANGE COLUMN FOR CHECKBOX -->
            <div *ngIf="column === 'Checked'">
              <th mat-header-cell *matHeaderCellDef="let dataInfos">
                <mat-checkbox class="example-margin" [(ngModel)]="checked" (click)="allcheckedActiveted(allChecked)"
                  #allChecked></mat-checkbox>
              </th>
              <td mat-cell *matCellDef="let dataInfos">
                <mat-checkbox value="{{dataInfos.candidat_id}}" (click)="checkedAction($event,check)" #check>
                </mat-checkbox>
              </td>
            </div>
            <div class="color-text">
              <div *ngIf="column === 'Candidats'">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>
                  {{ column }}
                </th>
                <td mat-cell *matCellDef="let dataInfos">
                  <span class="name-candidat">{{ dataInfos.Candidats }}</span><br />
                  {{ dataInfos.Email }}
                </td>
              </div>

              <th mat-header-cell *matHeaderCellDef mat-sort-header>
                {{ column }}
              </th>
              <td mat-cell *matCellDef="let dataInfos">
                {{ dataInfos[column] }}
              </td>

            </div>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns; let dataInfos"
            (click)="menuSidenav(sidenav, dataInfos)">

          </tr>
        </table>

        <mat-card *ngIf="isLoading" class="matcard_style">
          <mat-progress-spinner color="primary" mode="indeterminate">
          </mat-progress-spinner>
        </mat-card>
      </div>
      <!--Table-->
    </div>
  </div>

  <div *ngSwitchDefault id="editQuestion">...</div>
</div>

<!-- SIDENAV -->

<mat-sidenav-container class="sidenav-container">
  <mat-sidenav #sidenav mode="over" [(opened)]="opened">
    <div class="sidenav-content" *ngIf='currentCandidat.Candidats !== "" '>
      <div class="header-detail">
        <h2 class="sidenav_campaign_name">{{campaign.Name}} </h2>
        <span class="close-header-detail" (click)="sidnavClose(sidenav)">
          <i class="fa fa-close"></i>
        </span>
      </div>

      <h4 class="name-rapport-detailler">
        <i class="far fa-user-circle"></i>
        {{currentCandidat.Candidats}}
      </h4>
      <p> <i class="far fa-envelope"></i> {{currentCandidat.Email}}</p>
      <p> <i class="fas fa-poll-h"></i> Pourcentage de bonne réponses : {{currentCandidat.Score}} </p>
      <p><i class="far fa-clock"></i> Durée du test : {{currentCandidat.Duree}}</p>

      <hr class="sidenav_separator">

      <div class="sidenav_candidat_content">
        <div class="sidenav_candidat_result"
          *ngFor="let candidatPointTechno of currentCandidat.points[2].getpourcentByCandidat">
          <p class="sidenav_candidat_result">
            <span class="icon-techno" *ngIf="candidatPointTechno.techno === 'React'">
              <i class="fab fa-react"></i>
            </span>
            <span class="icon-techno" *ngIf="candidatPointTechno.techno === 'Javascript'">
              <i class="fab fa-js"></i>
            </span>
            {{candidatPointTechno.techno}}
          </p>

          <hr class="sidenav_separator">

          <p class="sidenav_candidat_score">
            {{candidatPointTechno.percentage}} %
          </p>
        </div>

        <hr class="sidenav_separator">

        <div class="sidenav_candidat_result">
          <p class="sidenav_candidat_text">Total :</p>
          <p class="sidenav_candidat_score">{{currentCandidat.Score}} </p>
        </div>
      </div>



      <div>
        <button class="button-rapport"
          [routerLink]="['/dashboard/campaigns', campaign.id, 'candidats', currentCandidat.candidat_id,'rapport-detaille']"
          mat-button>
          <i class="far fa-eye"></i>
          Voir le rapport détaillé
        </button>
        <button class="button-rapport" (click)="viewResultsPdf(currentCandidat.candidat_id)" mat-button> <i
            class="far fa-file-pdf"></i> Télécharger le PDF</button>
      </div>
    </div>
  </mat-sidenav>


</mat-sidenav-container>